// {{ ansible_managed }}
{% import 'object_attributes.j2' as attributes %}

{% for object_name, params in item.value.items() %}

{% set operators = params.pop('var_operators', None) %}

template {{ item.key }} "{{ object_name }}" {
{% if params.attributes is defined -%}
{{ attributes.attrs(params.attributes) -}}
{% endif -%}
{% if params.variables is defined -%}
{{ attributes.attrs(params.variables, 'vars.') -}}
{% endif -%}
{% if params.attributes is not defined and params.variables is not defined %}
{{ attributes.attrs(params) -}}
{% endif %}
{% if params.conditionals is defined -%}
{% for conditional in params.conditionals %}
{% set condition = conditional.pop('condition') %}
if ({{ condition }}) {
  {{ attributes.attrs(conditional) -}}
}
{% endfor %}
{% endif -%}
{% if operators is defined and operators is not none and operators|length -%}
{%- for operator, params in operators.items() %}
{{ attributes.attrs({ 'vars': params }, '', operator) }}
{% endfor -%}
{% endif -%}
}
{% endfor %}
